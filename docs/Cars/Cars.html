<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Data Mining</title>
    <meta charset="utf-8" />
    <meta name="author" content="Aldo Solari" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Data Mining
## I dati delle automobili
### Aldo Solari

---





# I dati delle automobili

* Tratto dal libro AS, Capitolo 2.1

* I dati delle automobili si riferiscono alle caratteristiche di 203 modelli di automobili importati negli USA nel 1985

* I dati originali sono disponibili qui: [ftp://ftp.ics.uci.edu/pub/machine-learning-databases/autos](ftp://ftp.ics.uci.edu/pub/machine-learning-databases/autos)
Questi dati sono stati elaborati convertendo le unità di misura, eliminado alcune variabili originarie, correggendo alcuni nomi di marche, etc.

* Obiettivo: prevedere il consumo di carburante (o, equivalentemente, la distanza percorsa per unità di carburante) in funzione di determinate caratteristiche di un'automobile

---


* brand   :             manufacturer (factor, 22 levels), casa produttrice (fattore, 22 livelli) 
* fuel    :       type of engine fuel (factor, 2 levels: diesel, gasoline), tipo di alimentazione del motore (fattore, 2 livelli) 
* aspiration :          type of engine aspiration (factor, 2 levels: standard, turbo), tipo di aspirazione del motore (fattore, 2 livelli)   
* bodystyle :         type of body style (factor, 5 levels: hardtop, wagon, sedan, hatchback, convertible),  tipo di carrozzeria (fattore, 5 livelli)  
* drive.wheels :       type of drive wheels (factor,  3 levels: 4wd, fwd, rwd), tipo di trazione (fattore,  3 livelli)    
* engine.location :    location of engine (factor, 2 levels: front, rear), posizione del motore (fattore, 2 livelli)  
* wheel.base :         distance between axes (cm), distanza tra gli assi (cm) 
* length :             length (cm), lunghezza (cm)      
* width :              width (cm), larghezza (cm)    
* height :             height (cm), altezza (cm)    
* curb.weight :        weight (kg), peso (kg)   
* engine size :        engine size (l), cilindrata (l)   
* compression.ratio :   compression ratio, rapporto di compressione   
* HP :                  horsepower, cavalli motore   
* peak.rot     :       number of peak revolutions per minute, numero di giri massimi del motore al minuto    
* __city.distance__ :      city distance covered (km/l), percorrenza urbana (km/l)   
* highway.distance :    highway distance (km/l), percorrenza extra urbana (km/l)  
* n.cylinders  :       number of cylinders, numero di cilindri

---



```r
rm(list=ls())
auto &lt;- read.table("http://azzalini.stat.unipd.it/Book-DM/auto.dat", header=TRUE, quote="\"")
dim(auto)
```

```
[1] 203  18
```

```r
# ci sono dati mancanti?
sum(is.na(auto))
```

```
[1] 0
```


---


```r
# tipologia di variabili
str(auto)
```

```
'data.frame':	203 obs. of  18 variables:
 $ brand            : chr  "alfa-romeo" "alfa-romeo" "alfa-romeo" "audi" ...
 $ fuel             : chr  "gas" "gas" "gas" "gas" ...
 $ aspiration       : chr  "std" "std" "std" "std" ...
 $ bodystyle        : chr  "convertible" "convertible" "hatchback" "sedan" ...
 $ drive.wheels     : chr  "rwd" "rwd" "rwd" "fwd" ...
 $ engine.location  : chr  "front" "front" "front" "front" ...
 $ wheel.base       : num  225 225 240 254 252 ...
 $ length           : num  429 429 435 449 449 ...
 $ width            : num  163 163 166 168 169 ...
 $ height           : num  124 124 133 138 138 ...
 $ curb.weight      : num  1156 1156 1280 1060 1281 ...
 $ engine.size      : num  2.13 2.13 2.49 1.79 2.23 ...
 $ compression.ratio: num  9 9 9 10 8 8.5 8.5 8.5 8.3 7 ...
 $ HP               : int  111 111 154 102 115 110 110 110 140 160 ...
 $ peak.rot         : int  5000 5000 5000 5500 5500 5500 5500 5500 5500 5500 ...
 $ city.distance    : num  8.93 8.93 8.08 10.2 7.65 ...
 $ highway.distance : num  11.48 11.48 11.05 12.75 9.35 ...
 $ n.cylinders      : int  4 4 6 4 5 5 5 5 5 5 ...
```

```r
auto$fuel &lt;- factor(auto$fuel)
```

---



```r
# dataset ridotto
names(auto)[which(names(auto)=="city.distance")] &lt;- "y"
vars &lt;- c("y", "engine.size","n.cylinders","curb.weight","fuel")
train &lt;- auto[,vars]
pairs(train[,-5], col=train$fuel)
```

![](Cars_files/figure-html/unnamed-chunk-3-1.png)&lt;!-- --&gt;

---


.pull-left[

```r
# y: istogramma
hist(train$y)
```

![](Cars_files/figure-html/unnamed-chunk-4-1.png)&lt;!-- --&gt;
]


.pull-right[

```r
# y: density plot
plot(density(train$y))
```

![](Cars_files/figure-html/unnamed-chunk-5-1.png)&lt;!-- --&gt;
]

---

.pull-left[

```r
# diagramma di dispersione
plot(y~engine.size, train, col=fuel) 
```

![](Cars_files/figure-html/unnamed-chunk-6-1.png)&lt;!-- --&gt;
]

.pull-right[

```r
# jitter
plot(jitter(y)~jitter(engine.size), train, col=fuel) 
```

![](Cars_files/figure-html/unnamed-chunk-7-1.png)&lt;!-- --&gt;
]

---

`$$Y = \beta_1 + \beta_2 \mathrm{engine.size} + \beta_3 \mathrm{engine.size}^2 + \beta_4 \mathrm{engine.size}^3 + \beta_5 I\{\mathrm{fuel} = \mathrm{gas}\} + \varepsilon$$`


```r
fit1 &lt;- lm(y ~ poly(engine.size, degree=3, raw=T) + fuel, train)
```

![](Cars_files/figure-html/unnamed-chunk-9-1.png)&lt;!-- --&gt;

---

`$$1/y = \beta_1 + \beta_2 \mathrm{engine.size} +  \beta_3 I\{\mathrm{fuel} = \mathrm{gas}\}+ \varepsilon$$`


```r
fit2&lt;-lm(1/y ~ engine.size + fuel, train)
```

.pull-left[
![](Cars_files/figure-html/unnamed-chunk-11-1.png)&lt;!-- --&gt;
]

.pull-right[
![](Cars_files/figure-html/unnamed-chunk-12-1.png)&lt;!-- --&gt;
]


---

`$$\log(y) = \beta_1 + \beta_2 \log(\mathrm{engine.size}) +  \beta_3 I\{\mathrm{fuel} = \mathrm{gas}\} + \varepsilon$$`

```r
fit3 &lt;- lm(log(y) ~ log(engine.size) + fuel, train)
```

.pull-left[
![](Cars_files/figure-html/unnamed-chunk-14-1.png)&lt;!-- --&gt;
]

.pull-right[
![](Cars_files/figure-html/unnamed-chunk-15-1.png)&lt;!-- --&gt;
]

---

.pull-left[

```r
plot(fit3, which=1)
```

![](Cars_files/figure-html/unnamed-chunk-16-1.png)&lt;!-- --&gt;
]

.pull-right[

```r
plot(fit3, which=4)
```

![](Cars_files/figure-html/unnamed-chunk-17-1.png)&lt;!-- --&gt;
]

---


```r
train[which(cooks.distance(fit3) &gt; .07), ]
```

```
       y engine.size n.cylinders curb.weight fuel
56 7.227      1.1471           2      1079.6  gas
57 7.227      1.1471           2      1079.6  gas
58 7.227      1.1471           2      1081.8  gas
59 6.802      1.3110           2      1134.0  gas
```

```r
table(train$n.cylinders)
```

```

  2   3   4   5   6   8  12 
  4   1 157  11  24   5   1 
```


---

$$
`\begin{aligned}
\log(y) = &amp; \beta_1 + \beta_2 \log(\mathrm{engine.size}) +  \beta_3 I\{\mathrm{fuel} = \mathrm{gas}\}  +\\ 
&amp; +\beta_4 \log(\mathrm{curb.weight})+ \beta_5I\{\mathrm{n.cylinders} = 2\} + \varepsilon
\end{aligned}`
$$


```r
# MSE.tr
fit1 = update(fit1, . ~ . +  log(curb.weight) + I(n.cylinders==2), train)
mean(resid(fit1)^2) 
```

```
[1] 1.07706
```

```r
fit2 = update(fit2, . ~ . +  log(curb.weight) + I(n.cylinders==2), train)
mean((train$y - 1/fitted(fit2))^2) 
```

```
[1] 1.143411
```

```r
fit3 = update(fit3, . ~ . +  log(curb.weight) + I(n.cylinders==2), train)
mean((train$y - exp(fitted(fit3)))^2) 
```

```
[1] 1.016788
```


---


Esercizio: https://supervised-ml-course.netlify.app/

![](images/SML.png)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
